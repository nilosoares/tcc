#!/bin/bash

if [[ -z "$1" ]] ; then
    echo "Por favor, informe o número da consulta (1, 8, 15, 20, 21 ou 22)."
    exit 1
fi

if [ ! -f "resources/tpc-h-mongo/queries/Q$1.js" ]; then
    echo "Por favor, informe uma consulta válida (1, 8, 15, 20, 21 ou 22)."
    exit 1
fi

# Executes a query in mongodb
workDir="/app/resources/tpc-h-mongo/queries"
command="touch Q$1.out; chmod 777 Q$1.out; mongo Q$1.js > Q$1.out"
docker-compose exec -d --user mongodb --workdir $workDir mongo /bin/bash -c "$command"