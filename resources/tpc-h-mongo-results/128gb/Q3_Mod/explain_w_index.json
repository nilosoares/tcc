{
   "stages":[
      {
         "$cursor":{
            "query":{
               "order.customer.mktsegment":{
                  "$eq":"AUTOMOBILE"
               },
               "order.orderdate":{
                  "$lt":{
                     "$date":"1995-03-18T00:00:00.000Z"
                  }
               },
               "shipdate":{
                  "$gt":{
                     "$date":"1995-03-18T00:00:00.000Z"
                  }
               }
            },
            "fields":{
               "discount":1,
               "extendedprice":1,
               "order.orderdate":1,
               "order.orderkey":1,
               "order.shippriority":1,
               "_id":0
            },
            "queryPlanner":{
               "plannerVersion":1,
               "namespace":"final.deals",
               "indexFilterSet":false,
               "parsedQuery":{
                  "$and":[
                     {
                        "order.customer.mktsegment":{
                           "$eq":"AUTOMOBILE"
                        }
                     },
                     {
                        "order.orderdate":{
                           "$lt":{
                              "$date":"1995-03-18T00:00:00.000Z"
                           }
                        }
                     },
                     {
                        "shipdate":{
                           "$gt":{
                              "$date":"1995-03-18T00:00:00.000Z"
                           }
                        }
                     }
                  ]
               },
               "winningPlan":{
                  "stage":"FETCH",
                  "filter":{
                     "$and":[
                        {
                           "order.customer.mktsegment":{
                              "$eq":"AUTOMOBILE"
                           }
                        },
                        {
                           "order.orderdate":{
                              "$lt":{
                                 "$date":"1995-03-18T00:00:00.000Z"
                              }
                           }
                        }
                     ]
                  },
                  "inputStage":{
                     "stage":"IXSCAN",
                     "keyPattern":{
                        "shipdate":1.0
                     },
                     "indexName":"C_10",
                     "isMultiKey":false,
                     "multiKeyPaths":{
                        "shipdate":[

                        ]
                     },
                     "isUnique":false,
                     "isSparse":false,
                     "isPartial":false,
                     "indexVersion":2,
                     "direction":"forward",
                     "indexBounds":{
                        "shipdate":[
                           "(new Date(795484800000), new Date(9223372036854775807)]"
                        ]
                     }
                  }
               },
               "rejectedPlans":[

               ]
            },
            "executionStats":{
               "executionSuccess":true,
               "nReturned":300207,
               "executionTimeMillis":714561,
               "totalKeysExamined":32258844,
               "totalDocsExamined":32258844,
               "executionStages":{
                  "stage":"FETCH",
                  "filter":{
                     "$and":[
                        {
                           "order.customer.mktsegment":{
                              "$eq":"AUTOMOBILE"
                           }
                        },
                        {
                           "order.orderdate":{
                              "$lt":{
                                 "$date":"1995-03-18T00:00:00.000Z"
                              }
                           }
                        }
                     ]
                  },
                  "nReturned":300207,
                  "executionTimeMillisEstimate":713578,
                  "works":32258845,
                  "advanced":300207,
                  "needTime":31958637,
                  "needYield":0,
                  "saveState":1,
                  "restoreState":1,
                  "isEOF":1,
                  "invalidates":0,
                  "docsExamined":32258844,
                  "alreadyHasObj":0,
                  "inputStage":{
                     "stage":"IXSCAN",
                     "nReturned":32258844,
                     "executionTimeMillisEstimate":12248,
                     "works":32258845,
                     "advanced":32258844,
                     "needTime":0,
                     "needYield":0,
                     "saveState":1,
                     "restoreState":1,
                     "isEOF":1,
                     "invalidates":0,
                     "keyPattern":{
                        "shipdate":1.0
                     },
                     "indexName":"C_10",
                     "isMultiKey":false,
                     "multiKeyPaths":{
                        "shipdate":[

                        ]
                     },
                     "isUnique":false,
                     "isSparse":false,
                     "isPartial":false,
                     "indexVersion":2,
                     "direction":"forward",
                     "indexBounds":{
                        "shipdate":[
                           "(new Date(795484800000), new Date(9223372036854775807)]"
                        ]
                     },
                     "keysExamined":32258844,
                     "seeks":1,
                     "dupsTested":0,
                     "dupsDropped":0,
                     "seenInvalidated":0
                  }
               },
               "allPlansExecution":[

               ]
            }
         }
      },
      {
         "$group":{
            "_id":{
               "o_orderkey":"$order.orderkey",
               "o_orderdate":"$order.orderdate",
               "o_shippriority":"$order.shippriority"
            },
            "revenue":{
               "$sum":{
                  "$multiply":[
                     "$extendedprice",
                     {
                        "$subtract":[
                           {
                              "$const":1.0
                           },
                           "$discount"
                        ]
                     }
                  ]
               }
            }
         }
      },
      {
         "$project":{
            "_id":false,
            "revenue":true,
            "o_orderkey":"$_id.o_orderkey",
            "o_orderdate":"$_id.o_orderdate",
            "o_shippriority":"$_id.o_shippriority"
         }
      },
      {
         "$sort":{
            "sortKey":{
               "revenue":-1,
               "o_orderdate":1
            },
            "limit":10
         }
      }
   ],
   "ok":1.0
}
