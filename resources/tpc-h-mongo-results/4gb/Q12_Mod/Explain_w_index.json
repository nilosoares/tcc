{
   "stages":[
      {
         "$cursor":{
            "query":{
               "$and":[
                  {
                     "shipmode":{
                        "$in":[
                           "REG AIR",
                           "AIR"
                        ]
                     }
                  },
                  {
                     "receiptdate":{
                        "$gt":{
                           "$date":"1993-01-01T00:00:00.000Z"
                        }
                     }
                  },
                  {
                     "receiptdate":{
                        "$lt":{
                           "$date":"1994-01-01T00:00:00.000Z"
                        }
                     }
                  },
                  {
                     "$expr":{
                        "$lt":[
                           "$commitdate",
                           "$receiptdate"
                        ]
                     }
                  },
                  {
                     "$expr":{
                        "$lt":[
                           "$shipdate",
                           "$commitdate"
                        ]
                     }
                  }
               ]
            },
            "fields":{
               "order.orderpriority":1,
               "shipmode":1,
               "_id":0
            },
            "queryPlanner":{
               "plannerVersion":1,
               "namespace":"final.deals",
               "indexFilterSet":false,
               "parsedQuery":{
                  "$and":[
                     {
                        "receiptdate":{
                           "$lt":{
                              "$date":"1994-01-01T00:00:00.000Z"
                           }
                        }
                     },
                     {
                        "receiptdate":{
                           "$gt":{
                              "$date":"1993-01-01T00:00:00.000Z"
                           }
                        }
                     },
                     {
                        "shipmode":{
                           "$in":[
                              "AIR",
                              "REG AIR"
                           ]
                        }
                     },
                     {
                        "$expr":{
                           "$lt":[
                              "$commitdate",
                              "$receiptdate"
                           ]
                        }
                     },
                     {
                        "$expr":{
                           "$lt":[
                              "$shipdate",
                              "$commitdate"
                           ]
                        }
                     }
                  ]
               },
               "winningPlan":{
                  "stage":"FETCH",
                  "filter":{
                     "$and":[
                        {
                           "$expr":{
                              "$lt":[
                                 "$commitdate",
                                 "$receiptdate"
                              ]
                           }
                        },
                        {
                           "$expr":{
                              "$lt":[
                                 "$shipdate",
                                 "$commitdate"
                              ]
                           }
                        }
                     ]
                  },
                  "inputStage":{
                     "stage":"IXSCAN",
                     "keyPattern":{
                        "shipmode":1.0,
                        "receiptdate":1.0
                     },
                     "indexName":"C_12_14",
                     "isMultiKey":false,
                     "multiKeyPaths":{
                        "shipmode":[

                        ],
                        "receiptdate":[

                        ]
                     },
                     "isUnique":false,
                     "isSparse":false,
                     "isPartial":false,
                     "indexVersion":2,
                     "direction":"forward",
                     "indexBounds":{
                        "shipmode":[
                           "[\"AIR\", \"AIR\"]",
                           "[\"REG AIR\", \"REG AIR\"]"
                        ],
                        "receiptdate":[
                           "(new Date(725846400000), new Date(757382400000))"
                        ]
                     }
                  }
               },
               "rejectedPlans":[

               ]
            },
            "executionStats":{
               "executionSuccess":true,
               "nReturned":311635,
               "executionTimeMillis":1554212,
               "totalKeysExamined":2593270,
               "totalDocsExamined":2593267,
               "executionStages":{
                  "stage":"FETCH",
                  "filter":{
                     "$and":[
                        {
                           "$expr":{
                              "$lt":[
                                 "$commitdate",
                                 "$receiptdate"
                              ]
                           }
                        },
                        {
                           "$expr":{
                              "$lt":[
                                 "$shipdate",
                                 "$commitdate"
                              ]
                           }
                        }
                     ]
                  },
                  "nReturned":311635,
                  "executionTimeMillisEstimate":1550937,
                  "works":2593270,
                  "advanced":311635,
                  "needTime":2281634,
                  "needYield":0,
                  "saveState":1,
                  "restoreState":1,
                  "isEOF":1,
                  "invalidates":0,
                  "docsExamined":2593267,
                  "alreadyHasObj":0,
                  "inputStage":{
                     "stage":"IXSCAN",
                     "nReturned":2593267,
                     "executionTimeMillisEstimate":23735,
                     "works":2593270,
                     "advanced":2593267,
                     "needTime":2,
                     "needYield":0,
                     "saveState":1,
                     "restoreState":1,
                     "isEOF":1,
                     "invalidates":0,
                     "keyPattern":{
                        "shipmode":1.0,
                        "receiptdate":1.0
                     },
                     "indexName":"C_12_14",
                     "isMultiKey":false,
                     "multiKeyPaths":{
                        "shipmode":[

                        ],
                        "receiptdate":[

                        ]
                     },
                     "isUnique":false,
                     "isSparse":false,
                     "isPartial":false,
                     "indexVersion":2,
                     "direction":"forward",
                     "indexBounds":{
                        "shipmode":[
                           "[\"AIR\", \"AIR\"]",
                           "[\"REG AIR\", \"REG AIR\"]"
                        ],
                        "receiptdate":[
                           "(new Date(725846400000), new Date(757382400000))"
                        ]
                     },
                     "keysExamined":2593270,
                     "seeks":3,
                     "dupsTested":0,
                     "dupsDropped":0,
                     "seenInvalidated":0
                  }
               },
               "allPlansExecution":[

               ]
            }
         }
      },
      {
         "$group":{
            "_id":{
               "shipmode":"$shipmode"
            },
            "high_line_count":{
               "$sum":{
                  "$cond":[
                     {
                        "$in":[
                           "$order.orderpriority",
                           {
                              "$const":[
                                 "1-URGENT",
                                 "2-HIGH"
                              ]
                           }
                        ]
                     },
                     {
                        "$const":1.0
                     },
                     {
                        "$const":0.0
                     }
                  ]
               }
            },
            "low_line_count":{
               "$sum":{
                  "$cond":[
                     {
                        "$in":[
                           "$order.orderpriority",
                           {
                              "$const":[
                                 "1-URGENT",
                                 "2-HIGH"
                              ]
                           }
                        ]
                     },
                     {
                        "$const":0.0
                     },
                     {
                        "$const":1.0
                     }
                  ]
               }
            }
         }
      },
      {
         "$project":{
            "_id":false,
            "low_line_count":true,
            "high_line_count":true,
            "shipmode":"$_id.shipmode"
         }
      },
      {
         "$sort":{
            "sortKey":{
               "shipmode":1
            }
         }
      }
   ],
   "ok":1.0
}
